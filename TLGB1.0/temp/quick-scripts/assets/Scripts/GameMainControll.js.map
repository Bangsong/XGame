{"version":3,"sources":["GameMainControll.js"],"names":["cc","Class","extends","Component","properties","bgAudio","url","AudioClip","default","playerPre","type","Prefab","npcPre","npcNewTime","Float","playerY","Integer","_gameHeight","boomAudio","heartPre","heartX","heartY","heartBronkenPre","heartCount","scoreNodeGroupPre","init","player","instantiate","node","addChild","GameWidth","width","playerX","randomMinus1To1","setPosition","p","scoreX","newHeart","scoreGroup","children","string","newNpc","npc","npcX","index","heart","onLoad","director","getCollisionManager","enabled","preloadScene","audioEngine","play","scheduler","getScheduler","schedule","update","dt","heartNode","find","y","height","sys","localStorage","setItem","getComponent","Label","loadScene"],"mappings":"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","file":"GameMainControll.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bgAudio:{\r\n            url:cc.AudioClip,\r\n            default:null\r\n        },\r\n        playerPre:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n        npcPre:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n        npcNewTime:{\r\n            type:cc.Float,\r\n            default:0.9,\r\n        },\r\n        playerY:{\r\n            type:cc.Integer,\r\n            default:-240\r\n        },\r\n        _gameHeight:345,\r\n        boomAudio:{\r\n            url:cc.AudioClip,\r\n            default:null\r\n        },\r\n        heartPre:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n        heartX:{type:cc.Integer,default:-453},\r\n        heartY:{type:cc.Integer,default:-285},\r\n        heartBronkenPre:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n        heartCount:{\r\n            type:cc.Integer,\r\n            default:3\r\n        },\r\n        scoreNodeGroupPre:{\r\n            type:cc.Prefab,\r\n            default:null\r\n        },\r\n    },\r\n\r\n    init () {\r\n        //初始化玩家\r\n        this.player = cc.instantiate(this.playerPre);\r\n        this.node.addChild(this.player);\r\n        var GameWidth = this.node.width/2 - 30;\r\n        var playerX = cc.randomMinus1To1() * GameWidth;\r\n        this.player.setPosition(cc.p(playerX,this.playerY));\r\n        //初始化heart\r\n        var scoreX = this.heartX + 60 * this.newHeart();\r\n        //初始化分数\r\n        this.scoreGroup = cc.instantiate(this.scoreNodeGroupPre);\r\n        this.node.addChild(this.scoreGroup);\r\n        this.scoreGroup.setPosition(cc.p(scoreX,this.heartY));\r\n        this.scoreGroup.children[1].string = 0;\r\n    },\r\n    newNpc () {\r\n        this.npc = cc.instantiate(this.npcPre);\r\n        this.node.addChild(this.npc);\r\n        var GameWidth = this.node.width/2 - 40;\r\n        var npcX = cc.randomMinus1To1() * GameWidth;\r\n        this.npc.setPosition(cc.p(npcX,this._gameHeight));\r\n    },\r\n    newHeart () {\r\n        var index = 0; \r\n        while(index < this.heartCount){\r\n            this.heart = cc.instantiate(this.heartPre);\r\n            this.node.addChild(this.heart);\r\n            this.heart.setPosition(cc.p(this.heartX + 47 * index++,this.heartY));\r\n        }\r\n        return index;\r\n    },\r\n    onLoad () {\r\n        //开启碰撞检测\r\n        cc.director.getCollisionManager().enabled = true;\r\n        // cc.director.getCollisionManager().enabledDebugDraw = true;\r\n        // cc.director.enabledDrawBoundingBox = true;\r\n        cc.director.preloadScene(\"GameOver\");\r\n        cc.audioEngine.play(this.bgAudio,true,0.5);\r\n        this.init();\r\n        var scheduler = cc.director.getScheduler();\r\n        scheduler.schedule(function(){\r\n            this.newNpc();\r\n        },this,this.npcNewTime);\r\n    },\r\n    update (dt) {\r\n        var heartNode = cc.find(\"Canvas/heart\");\r\n        if(!heartNode || this.player.y > this.node.height/2){\r\n            cc.sys.localStorage.setItem(\"score\",cc.find(\"Canvas/scoreNode/score\").getComponent(cc.Label).string);\r\n            // console.log(cc.sys.localStorage.getItem(\"score\"));\r\n            cc.director.loadScene(\"GameOver\");\r\n        }\r\n    },\r\n});\r\n"]}